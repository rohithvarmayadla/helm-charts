# VC-AuthN OIDC

![Version: 0.4.4](https://img.shields.io/badge/Version-0.4.4-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 2.3.0](https://img.shields.io/badge/AppVersion-2.3.0-informational?style=flat-square)

A Helm chart to deploy Verifiable Credential Identity Provider for OpenID Connect.

See [here](/docs/README.md) for background into how this integration is defined.

Make sure to read the [best practices](/docs/BestPractices.md) to be used when protecting a web application using `vc-authn-oidc`.

## TL;DR

```console
helm repo add owf	https://openwallet-foundation.github.io/helm-charts/
helm repo update
helm install my-release owf/vc-authn-oidc
```

## Prerequisites

- Kubernetes 1.19+
- Helm 3.2.0+
- PV provisioner support in the underlying infrastructure

## Installing the Chart

To install the chart with the release name `my-release`:

```console
helm repo add vc-authn-oidc https://openwallet-foundation.github.io/acapy-vc-authn-oidc
helm install my-release vc-authn-oidc/vc-authn-oidc
```

The command deploys vc-authn-oidc with AcaPY agent, along with the MongoDB and PostgrSQL prerequisites on the Kubernetes cluster in the default configuration. The [Parameters](#parameters) section lists the parameters that can be configured during installation.

> **Tip**: List all releases using `helm list`

## Installing the Chart configured for external AcaPy instance

If necessary, vc-authn-oidc can be installed without AcaPY agent. This is accomplished by setting `acapy.enabled` to `false` and providing the necessary values to configure vc-authn-oidc to connect to an external AcaPy instance.

| Name                            | Description                                                                                                                               | Value   |
| ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| `acapy.enabled`                 | Set to `false` to not deploy included AcaPy instance                                                                                      | `false` |
| `acapy.agentUrl`                | Provide URL of the AcaPy agent instance                                                                                                   |         |
| `acapy.adminUrl`                | Provide URL of the AcaPy agent admin interface                                                                                            |         |
| `acapy.argfile.yml.wallet-name` | Provide the name of the wallet (`wallet-id`)                                                                                              |         |
| `acapy.existingSecret`          | Provide the name of an existing secret containing the values for `adminApiKey` (otherwise set using `acapy.adminApiKey`), and `walletKey` |         |

To obtain the `controllerApiKey` to be used with the external AcaPy instance, run the following command:

```console
export WEBHOOK_API_KEY=$(kubectl get secret --namespace my-namespace my-release-api-key -o jsonpath="{.data.controllerApiKey}" | base64 --decode; echo)

echo $WEBHOOK_API_KEY
```

## Uninstalling the Chart

To uninstall/delete the `my-release` deployment:

```console
helm delete my-release
```

The command removes all the Kubernetes components but secrets and PVC's associated with the chart and deletes the release.

To delete the secrets and PVC's associated with `my-release`:

```console
kubectl delete secret,pvc --selector "app.kubernetes.io/instance"=my-release
```

> **Note**: Deleting the PVC's will delete postgresql data as well. Please be cautious before doing it.

## Parameters

### Common Configuration

| Name                | Description                                                                                                                                                                      | Value                                       |
| ------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------- |
| `nameOverride`      | String to override the helm chart name, second part of the prefix.                                                                                                               | `""`                                        |
| `fullnameOverride`  | String to fully override the helm chart name, full prefix. *Must be provided if using a custom release name that does not include the name of the helm chart (`vc-authn-oidc`).* | `""`                                        |
| `image.registry`    |                                                                                                                                                                                  | `ghcr.io`                                   |
| `image.repository`  |                                                                                                                                                                                  | `openwallet-foundation/acapy-vc-authn-oidc` |
| `image.pullPolicy`  |                                                                                                                                                                                  | `IfNotPresent`                              |
| `image.pullSecrets` |                                                                                                                                                                                  | `[]`                                        |
| `image.tag`         | Overrides the image tag which defaults to the chart appVersion.                                                                                                                  | `""`                                        |

### Controller Configuration

| Name                                                | Description                                                                                                                                                                                          | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| --------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `acapyTenancyMode`                                  | Agent tenancy mode, either `single` or `multi`                                                                                                                                                       | `single`                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `setNonRevoked`                                     | if True, the `non_revoked` attributed  will be added to each of the present-proof request `requested_attribute` and `requested_predicate` with 'from=0' and'to=`int(time.time())`                    | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `invitationLabel`                                   | For the invitations sent that include the proof, what to add as the my_label field. Can be used to identify the requester to the prover                                                              | `VC-AuthN`                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `useOobLocalDIDService`                             |                                                                                                                                                                                                      | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `walletDeepLinkPrefix`                              | URI scheme and host to use in deep links ((e.g. `{WALLET_DEEP_LINK_PREFIX}?c_i={connection invitation payload`))                                                                                     | `bcwallet://aries_proof-request`                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `controller.cameraRedirectUrl`                      | The redirect url can be a web link or the name of a template                                                                                                                                         | `wallet_howto`                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `controller.presentationExpireTime`                 | The number of time in seconds a proof request will be valid for                                                                                                                                      | `300`                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `controller.sessionTimeout.duration`                | The number of seconds an auth_sessions in the states defined in controllerSessionTimeoutConfig is kept for                                                                                           | `86400`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `controller.sessionTimeout.config`                  | The json list of auth session states that are safe for deletion                                                                                                                                      | `["expired","failed","abandoned"]`                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `controller.templateDirectory`                      | The directory where the controller templates are stored                                                                                                                                              | `/app/controller-config/templates`                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `controller.userVariableSubsitution`                | The placeholder for the user variable substitution file that can be used to add substitution variables                                                                                               | `# This is a default placeholder Python file
# Add any extensions to user variables here. Example below:

# def sub_days_plus_one(days: str) -> int:
# """Strings like '$sub_days_plus_one_4' will be replaced with the
# final number incremented by one. In this case 5.
# $sub_days_plus_one_4 -> 5
# $sub_days_plus_one_10 -> 11"""
# return int(days) + 1

# variable_substitution_map.add_variable_substitution(
#     r"\$sub_days_plus_one_(\d+)", sub_days_plus_one
# )` |
| `controller.customHtmlConfigMapName`                | ConfigMap file used to define the HTML file overrides                                                                                                                                                | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `controller.useConnectionBasedVerification`         | Whether to use connection-based proofs. If false connectionless OOB invites contain the proof.                                                                                                       | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `useHTTPS`                                          | Prepend Agent and Admin URLs with `https`                                                                                                                                                            | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `logLevel`                                          | Accepts one of the following values: CRITICAL, ERROR, WARNING, INFO, DEBUG                                                                                                                           | `INFO`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `auth.api.existingSecret`                           | Specify the name of the secret containing `controllerApiKey` key.                                                                                                                                    | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `auth.token.privateKey.filename`                    | Specify the name of the signing key file                                                                                                                                                             | `jwt-token.pem`                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `auth.token.privateKey.existingSecret`              | Specify the name of the secret containing the signing key to be mounted, if not specified, a new secret will be created.                                                                             | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `database.existingSecret`                           | Specify existing secret containing the keys `mongodb-root-password`, `mongodb-replica-set-key`, and `mongodb-passwords`. `database.secret.create` must be set to `false` when using existing secret. | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `podAnnotations`                                    | Map of annotations to add to the acapy pods                                                                                                                                                          | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `podSecurityContext.enabled`                        | Enable Pod securityContext                                                                                                                                                                           | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `podSecurityContext.fsGroupChangePolicy`            | Set filesystem group change policy                                                                                                                                                                   | `Always`                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `podSecurityContext.sysctls`                        | Set kernel settings using the sysctl interface                                                                                                                                                       | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `podSecurityContext.supplementalGroups`             | Set filesystem extra groups                                                                                                                                                                          | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `podSecurityContext.fsGroup`                        | Group to configure permissions for volumes                                                                                                                                                           | `1001`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `containerSecurityContext.enabled`                  | Enabled containers' Security Context                                                                                                                                                                 | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `containerSecurityContext.seLinuxOptions`           | Set SELinux options in container                                                                                                                                                                     | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `containerSecurityContext.runAsUser`                | Set containers' Security Context runAsUser                                                                                                                                                           | `1001`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `containerSecurityContext.runAsGroup`               | Set containers' Security Context runAsGroup                                                                                                                                                          | `1001`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `containerSecurityContext.runAsNonRoot`             | Set container's Security Context runAsNonRoot                                                                                                                                                        | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `containerSecurityContext.privileged`               | Set container's Security Context privileged                                                                                                                                                          | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `containerSecurityContext.readOnlyRootFilesystem`   | Set container's Security Context readOnlyRootFilesystem                                                                                                                                              | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `containerSecurityContext.allowPrivilegeEscalation` | Set container's Security Context allowPrivilegeEscalation                                                                                                                                            | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `containerSecurityContext.capabilities.drop`        | List of capabilities to be dropped                                                                                                                                                                   | `["ALL"]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `containerSecurityContext.seccompProfile.type`      | Set container's Security Context seccomp profile                                                                                                                                                     | `RuntimeDefault`                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `networkPolicy.enabled`                             | Enable network policies                                                                                                                                                                              | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `networkPolicy.ingress.enabled`                     | Enable ingress rules                                                                                                                                                                                 | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `networkPolicy.ingress.namespaceSelector`           | Namespace selector label that is allowed to access the Tenant proxy pods.                                                                                                                            | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `networkPolicy.ingress.podSelector`                 | Pod selector label that is allowed to access the Tenant proxy pods.                                                                                                                                  | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `service.type`                                      | Kubernetes Service type                                                                                                                                                                              | `ClusterIP`                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `service.port`                                      |                                                                                                                                                                                                      | `5000`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `ingress.enabled`                                   | Enable ingress record generation for controller                                                                                                                                                      | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `ingress.className`                                 | IngressClass that will be be used to implement the Ingress (Kubernetes 1.18+)                                                                                                                        | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `ingress.annotations`                               | Additional annotations for the Ingress resource.                                                                                                                                                     | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `ingress.tls`                                       | Enable TLS configuration for the host defined at ingress.                                                                                                                                            | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `resources.limits`                                  | The cpu and memory limit for the controller containers                                                                                                                                               | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `resources.requests.memory`                         | The requested memory for the controller containers                                                                                                                                                   | `128Mi`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `resources.requests.cpu`                            | The requested cpu for the controller containers                                                                                                                                                      | `10m`                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `replicaCount`                                      | Number of controller replicas to deploy                                                                                                                                                              | `1`                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `autoscaling.enabled`                               | Enable Horizontal POD autoscaling forthe  controller                                                                                                                                                 | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `autoscaling.minReplicas`                           | Minimum number of controller replicas                                                                                                                                                                | `1`                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `autoscaling.maxReplicas`                           | Maximum number of controller replicas                                                                                                                                                                | `2`                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `autoscaling.targetCPUUtilizationPercentage`        | Target CPU utilization percentage                                                                                                                                                                    | `80`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `autoscaling.targetMemoryUtilizationPercentage`     | Target Memory utilization percentage                                                                                                                                                                 | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `autoscaling.stabilizationWindowSeconds`            | Stabilization window in seconds                                                                                                                                                                      | `300`                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `serviceAccount.create`                             | Specifies whether a ServiceAccount should be created                                                                                                                                                 | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `serviceAccount.annotations`                        | Annotations for service account. Evaluated as a template. Only used if `create` is `true`.                                                                                                           | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `serviceAccount.automountServiceAccountToken`       | Automount service account token for the server service account                                                                                                                                       | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `serviceAccount.name`                               | Name of the service account to use. If not set and create is true, a name is generated using the fullname template.                                                                                  | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `affinity`                                          | Affinity for pods assignment                                                                                                                                                                         | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `nodeSelector`                                      | Node labels for pods assignment                                                                                                                                                                      | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `tolerations`                                       | Tolerations for pods assignment                                                                                                                                                                      | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

### Acapy Configuration

| Name                                                  | Description                                                                                                         | Value                               |
| ----------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------- | ----------------------------------- |
| `acapy.enabled`                                       | Deploy AcaPy agent instance                                                                                         | `true`                              |
| `acapy.image.registry`                                |                                                                                                                     | `ghcr.io`                           |
| `acapy.image.repository`                              |                                                                                                                     | `openwallet-foundation/acapy-agent` |
| `acapy.image.pullPolicy`                              |                                                                                                                     | `IfNotPresent`                      |
| `acapy.image.pullSecrets`                             |                                                                                                                     | `[]`                                |
| `acapy.image.tag`                                     |                                                                                                                     | `py3.12-1.3.1`                      |
| `acapy.serviceAccount.create`                         | Specifies whether a ServiceAccount should be created                                                                | `false`                             |
| `acapy.serviceAccount.annotations`                    | Annotations for service account. Evaluated as a template. Only used if `create` is `true`.                          | `{}`                                |
| `acapy.serviceAccount.automountServiceAccountToken`   | Automount service account token for the server service account                                                      | `true`                              |
| `acapy.serviceAccount.name`                           | Name of the service account to use. If not set and create is true, a name is generated using the fullname template. | `""`                                |
| `acapy.replicaCount`                                  | Number of AcaPy replicas to deploy                                                                                  | `1`                                 |
| `acapy.autoscaling.enabled`                           | Enable Horizontal POD autoscaling for AcaPy                                                                         | `true`                              |
| `acapy.autoscaling.minReplicas`                       | Minimum number of AcaPy replicas                                                                                    | `1`                                 |
| `acapy.autoscaling.maxReplicas`                       | Maximum number of AcaPy replicas                                                                                    | `100`                               |
| `acapy.autoscaling.targetCPUUtilizationPercentage`    | Target CPU utilization percentage                                                                                   | `80`                                |
| `acapy.autoscaling.targetMemoryUtilizationPercentage` | Target Memory utilization percentage                                                                                | `""`                                |
| `acapy.autoscaling.stabilizationWindowSeconds`        | Stabilization window in seconds                                                                                     | `300`                               |

### Acapy configuration file

Configuration file is mounted as is into the container. See the AcaPy documentation for details.
Note: Secure values of the configuration are passed via equivalent environment variables from secrets.

| Name                                              | Description                                                                                                                                                                                                                                     | Value              |
| ------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------ |
| `acapy.argfile.yml.admin-insecure-mode`           | Run the admin web server in insecure mode. DO NOT USE FOR PRODUCTION DEPLOYMENTS. The admin server will be publicly available to anyone who has access to the interface. An auto-generated admin API Key is supplied via `ACAPY-ADMIN-API-KEY`. | `false`            |
| `acapy.argfile.yml.auto-accept-invites`           | Automatically accept invites without firing a webhook event or waiting for an admin request. Default: false.                                                                                                                                    | `true`             |
| `acapy.argfile.yml.auto-accept-requests`          | Automatically accept connection requests without firing a webhook event or waiting for an admin request. Default: false.                                                                                                                        | `true`             |
| `acapy.argfile.yml.auto-ping-connection`          | Automatically send a trust ping immediately after a connection response is accepted. Some agents require this before marking a connection as 'active'. Default: false.                                                                          | `true`             |
| `acapy.argfile.yml.auto-provision`                | If the requested profile does not exist, initialize it with the given parameters.                                                                                                                                                               | `true`             |
| `acapy.argfile.yml.auto-respond-credential-offer` | Automatically respond to Indy credential offers with a credential request. Default: false                                                                                                                                                       | `true`             |
| `acapy.argfile.yml.auto-respond-messages`         | Automatically respond to basic messages indicating the message was received. Default: false.                                                                                                                                                    | `true`             |
| `acapy.argfile.yml.auto-verify-presentation`      | Automatically verify a presentation when it is received. Default: false.                                                                                                                                                                        | `true`             |
| `acapy.argfile.yml.genesis-transactions-list`     | Load YAML configuration for connecting to multiple HyperLedger Indy ledgers.                                                                                                                                                                    | `/tmp/ledgers.yml` |
| `acapy.argfile.yml.log-level`                     | Specifies a custom logging level as one of: ('debug', 'info', 'warning', 'error', 'critical')                                                                                                                                                   | `info`             |
| `acapy.argfile.yml.monitor-ping`                  | Send a webhook when a ping is sent or received.                                                                                                                                                                                                 | `true`             |
| `acapy.argfile.yml.multitenant-admin`             | Specify whether to enable the multitenant admin api.                                                                                                                                                                                            | `false`            |
| `acapy.argfile.yml.multitenant`                   | Enable multitenant mode.                                                                                                                                                                                                                        | `false`            |
| `acapy.argfile.yml.public-invites`                | Send invitations out using the public DID for the agent, and receive connection requests solicited by invitations which use the public DID. Default: false.                                                                                     | `true`             |
| `acapy.argfile.yml.read-only-ledger`              | Sets ledger to read-only to prevent updates. Default: false.                                                                                                                                                                                    | `true`             |
| `acapy.argfile.yml.wallet-local-did`              | If this parameter is set, provisions the wallet with a local DID from the '--seed' parameter, instead of a public DID to use with a Hyperledger Indy ledger. Default: false.                                                                    | `true`             |
| `acapy.argfile.yml.wallet-name`                   | Specifies the wallet name to be used by the agent. This is useful if your deployment has multiple wallets.                                                                                                                                      | `askar-wallet`     |
| `acapy.argfile.yml.wallet-storage-type`           | Specifies the type of Indy wallet backend to use. Supported internal storage types are 'basic' (memory), 'default' (sqlite), and 'postgres_storage'.  The default, if not specified, is 'default'.                                              | `postgres_storage` |
| `acapy.argfile.yml.wallet-type`                   | Specifies the type of Indy wallet provider to use. Supported internal storage types are 'basic' (memory) and 'indy'. The default (if not specified) is 'basic'.                                                                                 | `askar`            |
| `acapy.ledgers.yml`                               |                                                                                                                                                                                                                                                 | `{}`               |

### Acapy common configurations

| Name                                         | Description                                                                                              | Value         |
| -------------------------------------------- | -------------------------------------------------------------------------------------------------------- | ------------- |
| `acapy.resources.limits`                     | The cpu and memory limit for the Acapy containers                                                        | `{}`          |
| `acapy.resources.requests.memory`            | The requested memory for the Acapy containers                                                            | `384Mi`       |
| `acapy.resources.requests.cpu`               | The requested cpu for the Acapy containers                                                               | `250m`        |
| `acapy.service.ports.http`                   | AcaPy service HTTP port                                                                                  | `8021`        |
| `acapy.service.ports.admin`                  | AcaPy service admin port                                                                                 | `8022`        |
| `acapy.service.ports.ws`                     | AcaPy service websockets port                                                                            | `8023`        |
| `acapy.secrets.api.retainOnUninstall`        | When true, adds helm.sh/resource-policy: keep to generated api secret                                    | `true`        |
| `acapy.secrets.api.existingSecret`           | Name of an existing Secret providing API related keys. If set, the chart will NOT create the api secret. | `""`          |
| `acapy.secrets.api.secretKeys.adminApiKey`   | Key in the API secret holding the admin API key.                                                         | `adminApiKey` |
| `acapy.secrets.api.secretKeys.jwtKey`        | Key in the API secret holding the multitenant JWT signing secret.                                        | `jwt`         |
| `acapy.secrets.api.secretKeys.walletKey`     | Key in the API secret holding the wallet key.                                                            | `walletKey`   |
| `acapy.secrets.api.secretKeys.webhookapiKey` | Key in the API secret holding the webhook API key (used when embedding in webhook-url).                  | `webhookapi`  |
| `acapy.secrets.seed.retainOnUninstall`       | When true, adds helm.sh/resource-policy: keep to generated seed secret                                   | `true`        |
| `acapy.secrets.seed.existingSecret`          | Name of an existing Secret providing the wallet seed. If set, the chart will NOT create the seed secret. | `""`          |
| `acapy.secrets.seed.secretKeys.seed`         | Key in the seed secret holding the wallet seed value.                                                    | `seed`        |

### Acapy NetworkPolicy parameters

| Name                                       | Description                                                                                               | Value                             |
| ------------------------------------------ | --------------------------------------------------------------------------------------------------------- | --------------------------------- |
| `acapy.networkPolicy.enabled`              | Enable network policies                                                                                   | `true`                            |
| `acapy.networkPolicy.allowExternal`        | Don't require server label for connections                                                                | `false`                           |
| `acapy.networkPolicy.ingressNSMatchLabels` | Labels to match to allow traffic from other namespaces. Ignored if `networkPolicy.allowExternal` is true. | `{}`                              |
| `acapy.agentUrl`                           | Agent host, required if `enabled` is `false`, otherwise ignored                                           | `""`                              |
| `acapy.adminUrl`                           | Agent admin host, required if `enabled` is `false`, otherwise ignored                                     | `""`                              |
| `acapy.ingress.agent.enabled`              | Set to true to enable acapy ingress                                                                       | `false`                           |
| `acapy.ingress.agent.publicScheme`         | Scheme used to construct the public URL from the ingress host.                                            | `https`                           |
| `acapy.ingress.agent.hostname`             | When the ingress is enabled, a host pointing to this will be created                                      | `vc-authn-oidc-acapy.local`       |
| `acapy.ingress.admin.enabled`              | Set to true to enable acapy admin ingress                                                                 | `false`                           |
| `acapy.ingress.admin.hostname`             | When the ingress is enabled, a host pointing to this will be created                                      | `admin.vc-authn-oidc-acapy.local` |
| `acapy.postgresql.commonLabels`            | apply common labels to postgresql resources                                                               | `{}`                              |

### Cleanup Configuration

| Name                                         | Description                                                                                                                                                 | Value                               |
| -------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------- |
| `cleanup.cronjob.enabled`                    | Enable scheduled cleanup via Kubernetes CronJob                                                                                                             | `false`                             |
| `cleanup.cronjob.schedule`                   | Cron schedule for cleanup job (default: every hour)                                                                                                         | `0 * * * *`                         |
| `cleanup.cronjob.timeoutSeconds`             | Timeout for cleanup HTTP requests in seconds                                                                                                                | `300`                               |
| `cleanup.cronjob.retryDelaySeconds`          | Delay between retry attempts in seconds                                                                                                                     | `10`                                |
| `cleanup.cronjob.successfulJobsHistoryLimit` | Number of successful jobs to keep in history                                                                                                                | `3`                                 |
| `cleanup.cronjob.failedJobsHistoryLimit`     | Number of failed jobs to keep in history                                                                                                                    | `3`                                 |
| `cleanup.cronjob.resources.limits.cpu`       | CPU limit for cleanup job containers                                                                                                                        | `100m`                              |
| `cleanup.cronjob.resources.limits.memory`    | Memory limit for cleanup job containers                                                                                                                     | `128Mi`                             |
| `cleanup.cronjob.resources.requests.cpu`     | CPU request for cleanup job containers                                                                                                                      | `50m`                               |
| `cleanup.cronjob.resources.requests.memory`  | Memory request for cleanup job containers                                                                                                                   | `64Mi`                              |
| `cleanup.cronjob.nodeSelector`               | Node labels for cleanup job pod assignment                                                                                                                  | `{}`                                |
| `cleanup.cronjob.tolerations`                | Tolerations for cleanup job pod assignment                                                                                                                  | `[]`                                |
| `mongodb.image`                              | Pin image tag, and use bitnamilegacy repo.                                                                                                                  | `{}`                                |
| `mongodb.auth.enabled`                       | Enable authentication                                                                                                                                       | `true`                              |
| `mongodb.auth.existingSecret`                | Existing secret with MongoDB(&reg;) credentials (keys: `mongodb-passwords`, `mongodb-root-password`, `mongodb-metrics-password`, `mongodb-replica-set-key`) | `{{ include "global.fullname" . }}` |
| `mongodb.auth.usernames`                     | List of custom users to be created during the initialization                                                                                                | `["vcauthn"]`                       |
| `mongodb.auth.databases`                     | List of custom databases to be created during the initialization                                                                                            | `["vcauthn"]`                       |
| `mongodb.commonLabels`                       | Add labels to all the deployed resources (sub-charts are not considered). Evaluated as a template                                                           | `{}`                                |
| `mongodb.architecture`                       | MongoDB(&reg;) architecture (`standalone` or `replicaset`)                                                                                                  | `replicaset`                        |
| `mongodb.containerSecurityContext.enabled`   | Enable MongoDB(&reg;) container(s)' Security Context                                                                                                        | `false`                             |
| `mongodb.podSecurityContext.enabled`         | Enable MongoDB(&reg;) pod(s)' Security Context                                                                                                              | `false`                             |
| `mongodb.persistence.enabled`                | Enable MongoDB(&reg;) data persistence using PVC                                                                                                            | `true`                              |
| `mongodb.persistence.storageClass`           | PVC Storage Class for MongoDB(&reg;) data volume                                                                                                            | `default`                           |
| `mongodb.serviceAccount.create`              | Enable creation of ServiceAccount for MongoDB(&reg;) pods                                                                                                   | `false`                             |
| `mongodb.arbiter.enabled`                    | Enable deploying the arbiter                                                                                                                                | `false`                             |
| `mongodb.hidden.enabled`                     | Enable deploying the hidden nodes                                                                                                                           | `false`                             |
| `mongodb.metrics.enabled`                    | Enable using a sidecar Prometheus exporter                                                                                                                  | `false`                             |

---

Autogenerated from chart metadata using [helm-docs v1.11.0](https://github.com/norwoodj/helm-docs/releases/v1.11.0)
